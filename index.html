<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Xbox API Demo Starter</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 2rem; background: #121212; color: #eee; }
    button { font-size: 1.2rem; padding: 1rem 2rem; background: #107c10; border: none; color: white; border-radius: 8px; cursor: pointer; }
    #output { margin-top: 1rem; white-space: pre-wrap; background: #222; padding: 1rem; border-radius: 8px; }
  </style>
</head>
<body>

<h1>Xbox API Demo (conceptual)</h1>
<button id="loginBtn">Login with Xbox (Microsoft Account)</button>
<pre id="output">Not logged in</pre>

<script>
  const clientId = 'YOUR_MICROSOFT_APP_CLIENT_ID'; // Replace with your app's client id
  const redirectUri = window.location.origin + window.location.pathname; // Your site URL

  // Scopes needed for Xbox Live
  const scopes = [
    'XboxLive.signin',
    'XboxLive.offline_access',
    'User.Read'
  ];

  // Simple OAuth implicit flow URL
  function getOAuthUrl() {
    return `https://login.microsoftonline.com/consumers/oauth2/v2.0/authorize?` +
      `client_id=${encodeURIComponent(clientId)}` +
      `&response_type=token` +
      `&redirect_uri=${encodeURIComponent(redirectUri)}` +
      `&scope=${encodeURIComponent(scopes.join(' '))}` +
      `&response_mode=fragment` +
      `&state=12345` +
      `&prompt=select_account`;
  }

  // Parse URL hash for access token
  function parseHash() {
    const hash = window.location.hash.substring(1);
    const params = new URLSearchParams(hash);
    return {
      access_token: params.get('access_token'),
      expires_in: params.get('expires_in'),
      token_type: params.get('token_type'),
      state: params.get('state')
    };
  }

  // Show user Xbox profile (mock example using Microsoft Graph User API)
  async function fetchUserProfile(accessToken) {
    const res = await fetch('https://graph.microsoft.com/v1.0/me', {
      headers: { Authorization: 'Bearer ' + accessToken }
    });
    if(!res.ok) throw new Error('Failed to fetch profile');
    return await res.json();
  }

  document.getElementById('loginBtn').onclick = () => {
    window.location.href = getOAuthUrl();
  };

  (async () => {
    const tokenData = parseHash();
    if(tokenData.access_token) {
      document.getElementById('output').textContent = 'Fetching Xbox profile...';
      try {
        const profile = await fetchUserProfile(tokenData.access_token);
        document.getElementById('output').textContent = JSON.stringify(profile, null, 2);
      } catch(e) {
        document.getElementById('output').textContent = 'Error fetching profile: ' + e.message;
      }
    }
  })();
</script>

</body>
</html>
