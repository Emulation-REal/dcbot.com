<!DOCTYPE html>
<html>
<head>
  <title>Simple 3D FPS Game</title>
  <style>
    body { margin: 0; overflow: hidden; }
    canvas { display: block; }
    #info { position: absolute; top: 10px; left: 10px; color: white; font-family: Arial; }
  </style>
</head>
<body>
  <div id="info">Health: <span id="health">100</span></div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
  <script>
    // Scene setup
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer();
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    // Player variables
    let player = { health: 100, speed: 0.1, jumpHeight: 0.2, velocity: new THREE.Vector3(), canJump: true };
    camera.position.set(0, 1, 5);

    // Enemy (simple cube behind a wall)
    const enemyGeometry = new THREE.BoxGeometry(1, 1, 1);
    const enemyMaterial = new THREE.MeshBasicMaterial({ color: 0xff0000 });
    const enemy = new THREE.Mesh(enemyGeometry, enemyMaterial);
    enemy.position.set(0, 0.5, -5);
    scene.add(enemy);

    // Wall
    const wallGeometry = new THREE.BoxGeometry(10, 2, 0.2);
    const wallMaterial = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
    const wall = new THREE.Mesh(wallGeometry, wallMaterial);
    wall.position.set(0, 1, -2);
    scene.add(wall);

    // Floor
    const floorGeometry = new THREE.PlaneGeometry(20, 20);
    const floorMaterial = new THREE.MeshBasicMaterial({ color: 0x808080 });
    const floor = new THREE.Mesh(floorGeometry, floorMaterial);
    floor.rotation.x = -Math.PI / 2;
    scene.add(floor);

    // Keyboard controls
    const keys = {};
    document.addEventListener('keydown', (e) => keys[e.code] = true);
    document.addEventListener('keyup', (e) => keys[e.code] = false);

    // Mouse look
    let yaw = 0, pitch = 0;
    document.addEventListener('mousemove', (e) => {
      yaw -= e.movementX * 0.002;
      pitch -= e.movementY * 0.002;
      pitch = Math.max(-Math.PI / 2, Math.min(Math.PI / 2, pitch));
      camera.rotation.set(pitch, yaw, 0);
    });
    document.body.requestPointerLock();

    // Game loop
    function animate() {
      requestAnimationFrame(animate);

      // Movement
      const direction = new THREE.Vector3();
      if (keys['KeyW']) direction.z -= 1;
      if (keys['KeyS']) direction.z += 1;
      if (keys['KeyA']) direction.x -= 1;
      if (keys['KeyD']) direction.x += 1;
      direction.normalize().multiplyScalar(player.speed);
      camera.position.add(direction.applyQuaternion(camera.quaternion));

      // Jump
      if (keys['Space'] && player.canJump) {
        player.velocity.y = player.jumpHeight;
        player.canJump = false;
      }

      // Gravity
      player.velocity.y -= 0.01;
      camera.position.y += player.velocity.y;
      if (camera.position.y <= 1) {
        camera.position.y = 1;
        player.velocity.y = 0;
        player.canJump = true;
      }

      // Enemy "AI" (simple damage if close)
      const distance = camera.position.distanceTo(enemy.position);
      if (distance < 2 && player.health > 0) {
        player.health -= 0.5;
        document.getElementById('health').textContent = Math.max(0, Math.floor(player.health));
      }

      // Respawn
      if (player.health <= 0) {
        player.health = 100;
        camera.position.set(0, 1, 5);
        document.getElementById('health').textContent = player.health;
      }

      renderer.render(scene, camera);
    }
    animate();

    // Handle window resize
    window.addEventListener('resize', () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });
  </script>
</body>
</html>
